<nav class="navbar navbar-expand-lg sticky-top bg-white border-bottom shadow-sm">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center" href="/">
      <i class="fa-sharp fa-solid fa-bed brand-icon me-2" id="brand-icon"></i>
      <span id="explore" class="fw-bold">Wanderlust</span>
    </a>

    <div class="d-flex align-items-center d-lg-none">
      <div class="toggle-container me-2">
        <button class="darkModeToggle dark-mode-toggle border-0 bg-transparent p-0">
          <i class="toggleIcon bx bxs-moon fs-4"></i>
        </button>
      </div>
      <button class="navbar-toggler border-0 p-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mx-auto text-center text-lg-start">
        <li class="nav-item">
          <a class="nav-link" id="air_bnb" href="/listing/new">Add property</a>
        </li>
        <li class="nav-item">
          <a class="nav-link hight-light" href="/about">About Us</a>
        </li>
        <li class="nav-item">
          <a class="nav-link hight-light" href="/top-listings">Top Properties</a>
        </li>
        <li class="nav-item">
          <a class="nav-link hight-light" href="/contact">Contact Us</a>
        </li>
        <li class="nav-item">
          <a class="nav-link hight-light" href="/feedback">Feedbacks</a>
        </li>
        <li class="nav-item">
          <a class="nav-link hight-light" href="/blogs">Blogs</a>
        </li>
        
        <li class="nav-item d-lg-none">
          <a class="nav-link" href="/listing/#faq">FAQs</a>
        </li>

        <% if(!currUser) { %>
          <li class="nav-item d-lg-none mt-2">
            <a class="btn btn-outline-danger w-100 mb-2" href="/login">Log in</a>
          </li>
          <li class="nav-item d-lg-none">
            <a class="btn btn-danger w-100" href="/signup">Sign up</a>
          </li>
        <% } else { %>
          <li class="nav-item d-lg-none mt-2">
            <a class="nav-link fw-bold border-top pt-2" href="/profile">Your profile</a>
          </li>
          <li class="nav-item d-lg-none">
            <a class="nav-link text-danger" href="/logout">Log out</a>
          </li>
        <% } %>
      </ul>

      <div class="search-box-wrapper my-3 my-lg-0 mx-lg-3">
        <form class="d-flex" action="/listing/search" method="post">
          <button class="btn btn-outline-secondary nearby-btn  me-2" type="button" onclick="getNearbyListings()" title="Find nearby">
            <i class="fa-solid fa-location-crosshairs"></i>
          </button>
          <div class="input-group">
            <input class="form-control" type="search" name="query" placeholder="Search destinations.." aria-label="Search">
            <button class="btn btn-danger" type="submit">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </form>
      </div>

      <div class="d-none d-lg-flex align-items-center">
        <div class="toggle-container me-3">
          <button class="darkModeToggle dark-mode-toggle border-0 bg-transparent p-0">
            <i class="toggleIcon bx bxs-moon fs-4"></i>
          </button>
        </div>

        <div class="dropdown">
          <a role="button" class="drop-button d-flex align-items-center text-decoration-none text-dark border p-1 px-2 rounded-pill" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fa-solid fa-bars me-2"></i>
            <% if(!currUser) { %>
              <img src="/assets/noprofilenav.png" alt="User" class="nav-profile rounded-circle" width="30" height="30">
            <% } else { %>
              <img src="<%= (currUser.profilePicture && currUser.profilePicture.purl) ? profilePic : '/assets/profile.png' %>" alt="User" class="nav-profile rounded-circle" width="30" height="30">
            <% } %>
          </a>
          <ul class="dropdown-menu dropdown-menu-end shadow border-0 mt-2">
            <% if(!currUser) { %>
              <li><a class="dropdown-item py-2" href="/login"><i class="fa-solid fa-right-to-bracket me-2 text-danger"></i>Login</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item py-2" href="/signup"><i class="fa-solid fa-user-plus me-2"></i>Signup</a></li>
            <% } else { %>
              <li><a class="dropdown-item py-2" href="/profile"><i class="fa-solid fa-user me-2"></i>Your profile</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item py-2 text-danger" href="/logout"><i class="fa-solid fa-right-from-bracket me-2"></i>Log Out</a></li>
            <% } %>
          </ul>
        </div>
      </div>

    </div>
  </div>
</nav>

<style>
  /* Ensure the navbar brand stays aligned */
  .navbar-brand #explore {
    font-size: 1.25rem;
    color: #333;
    letter-spacing: -0.5px;
  }

  .brand-icon {
    color: #fe424d;
    font-size: 2rem;
    transition: transform 0.3s ease;
  }

  .brand-icon:hover {
    transform: scale(1.1) rotate(-10deg);
  }

  /* Desktop Profile Button Styling */
  .drop-button {
    transition: box-shadow 0.2s;
    background: #fff;
  }

  .drop-button:hover {
    box-shadow: 0 2px 4px rgba(0,0,0,0.18);
  }

  /* Nav Link Hover Effects */
  .nav-link {
    font-weight: 500;
    color: #555 !important;
  }

  .nav-link:hover {
    color: #fe424d !important;
  }

  /* Fix for Mobile Collapse */
  @media (max-width: 991.98px) {
    .navbar-collapse {
      padding-top: 1rem;
      padding-bottom: 1rem;
    }
    .search-box-wrapper .input-group {
      width: 100%;
    }
  }
</style>